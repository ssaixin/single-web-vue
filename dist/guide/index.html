<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>网站前端开发指北 | 微前端文档</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="shortcut icon" type="image/x-icon" href="/single-web/jyjwebdocs/favicon.ico">
    <meta name="description" content="微前端文档描述">
    
    <link rel="preload" href="/single-web/assets/css/0.styles.2de6e7fd.css" as="style"><link rel="preload" href="/single-web/assets/js/app.25aedf86.js" as="script"><link rel="preload" href="/single-web/assets/js/2.bdf7e3fa.js" as="script"><link rel="preload" href="/single-web/assets/js/8.f7cfc9af.js" as="script"><link rel="prefetch" href="/single-web/assets/js/10.72472155.js"><link rel="prefetch" href="/single-web/assets/js/11.29bea47e.js"><link rel="prefetch" href="/single-web/assets/js/12.b6713d04.js"><link rel="prefetch" href="/single-web/assets/js/3.2def807a.js"><link rel="prefetch" href="/single-web/assets/js/4.ba3164ba.js"><link rel="prefetch" href="/single-web/assets/js/5.75a3592b.js"><link rel="prefetch" href="/single-web/assets/js/6.0377ba0c.js"><link rel="prefetch" href="/single-web/assets/js/7.6aae7ebf.js"><link rel="prefetch" href="/single-web/assets/js/9.61fec93e.js">
    <link rel="stylesheet" href="/single-web/assets/css/0.styles.2de6e7fd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/single-web/" class="home-link router-link-active"><!----> <span class="site-name">微前端文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/single-web/guide/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  指南
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="推荐" class="dropdown-title"><span class="title">推荐</span> <span class="arrow down"></span></button> <button type="button" aria-label="推荐" class="mobile-dropdown-title"><span class="title">推荐</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          插件
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://github.com/systemjs/systemjs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  SystemJs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://single-spa.js.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  single-spa
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://qiankun.umijs.org/zh/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  qiankun
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/single-web/guide/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  指南
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="推荐" class="dropdown-title"><span class="title">推荐</span> <span class="arrow down"></span></button> <button type="button" aria-label="推荐" class="mobile-dropdown-title"><span class="title">推荐</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          插件
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://github.com/systemjs/systemjs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  SystemJs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://single-spa.js.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  single-spa
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://qiankun.umijs.org/zh/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  qiankun
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>关于微前端</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/single-web/guide/notes/one.html" class="sidebar-link">微前端</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>关于single-spa</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>single-spa-vue源码解析</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="网站前端开发指北"><a href="#网站前端开发指北" class="header-anchor">#</a> 网站前端开发指北</h1> <h2 id="快速导航"><a href="#快速导航" class="header-anchor">#</a> 快速导航</h2> <TOC include-level="2,3"></TOC> <h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p>网站后台开发，前端部分日常操作总结，帮助大家开发通用功能，和处理常见问题（ps: 默认谷歌浏览器）</p> <h2 id="网页布局"><a href="#网页布局" class="header-anchor">#</a> 网页布局</h2> <p>非弹窗页的布局结构分为2类：</p> <p>1、带左侧树形结构的
<img src="/Blog/images/%E5%B7%A6%E4%BE%A7%E6%9C%89%E6%A0%91%E7%BB%93%E6%9E%84.png" alt=""></p> <p>2、普通结构（无左侧树形）
<img src="/Blog/images/%E6%99%AE%E9%80%9A%E7%BB%93%E6%9E%84.png" alt=""></p> <h3 id="带左侧树形结构"><a href="#带左侧树形结构" class="header-anchor">#</a> 带左侧树形结构</h3> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ui_layout<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mini-layout<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span>100%<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>100%<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">region</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>west<span class="token punctuation">&quot;</span></span> <span class="token attr-name">showHeader</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>240<span class="token punctuation">&quot;</span></span> <span class="token attr-name">splitSize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>6<span class="token punctuation">&quot;</span></span> <span class="token attr-name">showSplitIcon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">maxWidth</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>500<span class="token punctuation">&quot;</span></span>
         <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">border</span><span class="token punctuation">:</span>none<span class="token punctuation">;</span> <span class="token property">background</span><span class="token punctuation">:</span>#F6FAFD<span class="token punctuation">;</span> <span class="token property">border-right</span><span class="token punctuation">:</span> solid 1px #e5e5e5<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">padding</span><span class="token punctuation">:</span>5px<span class="token punctuation">;</span> <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>organ_catalog_tree<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ztree<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">region</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">border</span><span class="token punctuation">:</span>none<span class="token punctuation">;</span> <span class="token property">overflow</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span> <span class="token property">border-left</span><span class="token punctuation">:</span> solid 1px #e5e5e5<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>主体内容id<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><code>splitSize=&quot;6&quot; showSplitIcon=&quot;true&quot;</code>是成对出现的属性，表示带拖拽按钮宽度为6</p> <p><code>splitSize=&quot;0&quot;</code>表示不可拖拽</p> <p><code>maxWidth=&quot;500&quot;</code>表示可展开最大宽度</p> <hr> <p>如何渲染主体内容呢？这个带树形的一般都是通过点击树节点调用方法载页面。具体调用方法如下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 加载内容</span>
<span class="token keyword">var</span> <span class="token function-variable function">getContentApp</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> App<span class="token punctuation">.</span><span class="token function">getContentAjax</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#主体内容id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 传递参数</span>
App<span class="token punctuation">.</span><span class="token function">getContentAjax</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#主体内容id'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string">'&lt;script&gt;var _govYearData = '</span> <span class="token operator">+</span> data <span class="token operator">+</span> <span class="token string">';&lt;\/script&gt;'</span> <span class="token operator">+</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>因为<code>getContentApp</code>函数返回的是ajax对象，所以可以接着链式调用<code>getContentApp(url).done(function(){ xxx})</code></p> <p><strong>主体内容中存在添加/编辑页时（非弹窗形式），它的打开方式依旧是<code>getContentApp(url)</code></strong></p> <h3 id="普通结构-无左侧树形"><a href="#普通结构-无左侧树形" class="header-anchor">#</a> 普通结构（无左侧树形）</h3> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ui_layout<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mini-layout<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span>100%<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>100%<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">region</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">border</span><span class="token punctuation">:</span>none<span class="token punctuation">;</span> <span class="token property">overflow</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>portlet light<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>portlet-body<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token comment">&lt;!--搜索部分--&gt;</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>table-toolbar<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>row<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token comment">&lt;!--左侧按钮区--&gt;</span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>col-md-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn-group<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn btn-default btn-search<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript"><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>添加<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                        <span class="token comment">&lt;!--右侧form查询区--&gt;</span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>col-md-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-inline tr<span class="token punctuation">&quot;</span></span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

                <span class="token comment">&lt;!--表格or列表区--&gt;</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page_cont<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>上面是一个健全的普通页面布局，有的时候出现页面超出却没有滚动条，就是你的之前使用的页面布局方式有问题导致的。</p> <p><strong>普通结构中存在添加/编辑页时（非弹窗形式），它的打开方式是<code>App.getContentHtml(url);</code>即可</strong></p> <div class="custom-block warning"><p class="custom-block-title">注意</p> <p>这两类布局方式，在js加载时都需要<code>mini.parse();</code></p></div> <h2 id="菜单跳转"><a href="#菜单跳转" class="header-anchor">#</a> 菜单跳转</h2> <p>想在首页跳转到特点的二级菜单下
<img src="/Blog/images/%E8%8F%9C%E5%8D%95%E5%AE%9A%E4%BD%8D.png" alt=""></p> <p><code>App.setSidebarMenuActive(Ls.base64.encode(&quot;二级菜单data-id&quot;));</code></p> <p>此方法只能对二级非父级菜单有效</p> <h2 id="弹窗页"><a href="#弹窗页" class="header-anchor">#</a> 弹窗页</h2> <h3 id="弹窗页调用方式"><a href="#弹窗页调用方式" class="header-anchor">#</a> 弹窗页调用方式</h3> <p>1.通过url打开弹窗页</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// url 弹窗地址 弹窗宽和高</span>
Ls<span class="token punctuation">.</span><span class="token function">openWin</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token string">'1000px'</span><span class="token punctuation">,</span> <span class="token string">'500px'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    maxable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否有最大化按钮</span>
    isDefaultMax<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否默认最大化</span>
    id<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token comment">// 弹窗id</span>
    title<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token comment">// 弹窗标题名</span>
    <span class="token function-variable function">close</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 关闭弹窗后的回调函数</span>
        <span class="token comment">// 存在返回值时，再触发刷新加载等事件</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">ok</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 弹窗底部确认按钮事件 （不推荐使用这种方式， 弹窗页里的提交事件就在弹窗页里完成）</span>
        <span class="token keyword">var</span> iframe <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>iframe<span class="token punctuation">.</span>contentWindow<span class="token punctuation">;</span> <span class="token comment">// 获取弹窗对象</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>iframe<span class="token punctuation">.</span>document<span class="token punctuation">.</span>body<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        iframe<span class="token punctuation">.</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#&quot;</span> <span class="token operator">+</span> iframe<span class="token punctuation">.</span>cur<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 弹窗里的提交事件</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>2.通过传入HTMLElement打开弹窗 （适用于简单的内容的）</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>cur<span class="token punctuation">.</span>backWin <span class="token operator">=</span> Ls<span class="token punctuation">.</span><span class="token function">openWin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    content<span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'comment-wrap'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// dom元素id，在当前页将结构写好传入</span>
    id<span class="token operator">:</span> <span class="token string">'comment'</span><span class="token punctuation">,</span>
    title<span class="token operator">:</span> <span class="token string">'评论'</span><span class="token punctuation">,</span>
    width<span class="token operator">:</span> <span class="token string">'400px'</span><span class="token punctuation">,</span>
    height<span class="token operator">:</span> <span class="token string">'200px'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">ok</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token keyword">function</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     cur<span class="token punctuation">.</span>backWin<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre></div><h3 id="弹窗页参数接受、定义底部按钮、关闭事件"><a href="#弹窗页参数接受、定义底部按钮、关闭事件" class="header-anchor">#</a> 弹窗页参数接受、定义底部按钮、关闭事件</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> cur <span class="token operator">=</span> <span class="token punctuation">{</span>
    api<span class="token operator">:</span> Ls<span class="token punctuation">.</span>getWin<span class="token punctuation">.</span>api<span class="token punctuation">,</span> <span class="token comment">// 弹窗对象绑定的方法api</span>
    win<span class="token operator">:</span> Ls<span class="token punctuation">.</span>getWin<span class="token punctuation">.</span>win<span class="token punctuation">,</span> <span class="token comment">// 获取父级页面的Windows对象</span>
    dialog<span class="token operator">:</span> Ls<span class="token punctuation">.</span>getWin<span class="token punctuation">.</span>dialog<span class="token punctuation">,</span> <span class="token comment">// 子窗口数据读取父窗口传输的数据 （不常用）</span>
    params<span class="token operator">:</span> <span class="token punctuation">{</span>
        id<span class="token operator">:</span> Ls<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p>读取url上的参数 (也可以后端直接渲染得到)</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>父页面
url <span class="token operator">+</span> <span class="token string">'?id=1&amp;pid=0'</span>

弹窗页
Ls<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span>  Ls<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'pid'</span><span class="token punctuation">)</span>
</code></pre></div><p>弹窗底部按钮定义</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code> cur<span class="token punctuation">.</span>api<span class="token punctuation">.</span><span class="token function">button</span><span class="token punctuation">(</span>
     <span class="token punctuation">{</span>
         id<span class="token operator">:</span> <span class="token string">'save'</span><span class="token punctuation">,</span>
         className<span class="token operator">:</span> <span class="token string">'btn-save'</span><span class="token punctuation">,</span>
         focus<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
         name<span class="token operator">:</span> <span class="token string">'保存'</span><span class="token punctuation">,</span>
         <span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
             <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 在保存完之后再执行关闭</span>
             <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// return false 阻止弹窗关闭</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token punctuation">{</span>
         id<span class="token operator">:</span> <span class="token string">'save2'</span><span class="token punctuation">,</span>
         className<span class="token operator">:</span> <span class="token string">'btn-submit'</span><span class="token punctuation">,</span>
         name<span class="token operator">:</span> <span class="token string">'保存并发布'</span><span class="token punctuation">,</span>
         <span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
             <span class="token function">Publish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token punctuation">{</span>
         id<span class="token operator">:</span> <span class="token string">'back'</span><span class="token punctuation">,</span>
         className<span class="token operator">:</span> <span class="token string">'btn-cancel'</span><span class="token punctuation">,</span>
         name<span class="token operator">:</span> <span class="token string">'取消'</span><span class="token punctuation">,</span>
     <span class="token punctuation">}</span>
 <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>关闭事件</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code> <span class="token comment">// 直接关闭</span>
Ls<span class="token punctuation">.</span><span class="token function">winClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 关闭并传递数据or状态</span>
cur<span class="token punctuation">.</span>api<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>xxx<span class="token punctuation">)</span><span class="token punctuation">;</span>

这样Ls<span class="token punctuation">.</span>openWin中的close回调函数就接受到参数了，根据参数父页面处理刷新加载等操作
</code></pre></div><p>dialog的使用</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>父页面
cur<span class="token punctuation">.</span>dialog<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token string">'sysData'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 定义个变量，传入数据</span>
Ls<span class="token punctuation">.</span><span class="token function">openWin</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token string">'1000px'</span><span class="token punctuation">,</span> <span class="token string">'500px'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">close</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cur<span class="token punctuation">.</span>dialog<span class="token punctuation">.</span><span class="token function">removeData</span><span class="token punctuation">(</span><span class="token string">'sysData'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 销毁这个变量</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

弹窗页
<span class="token keyword">var</span> data <span class="token operator">=</span> cur<span class="token punctuation">.</span>dialog<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token string">'sysData'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取到数据</span>
</code></pre></div><h3 id="弹窗页布局"><a href="#弹窗页布局" class="header-anchor">#</a> 弹窗页布局</h3> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!--公用头部必须--&gt;</span>
#parse(&quot;_page_layout/_header.vm&quot;)
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page-body-white<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>portlet light<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>portlet-body form<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--主体内容--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--公用顶部必须--&gt;</span>
#parse(&quot;_page_layout/_footer.vm&quot;)
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">

</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="自定义弹窗"><a href="#自定义弹窗" class="header-anchor">#</a> 自定义弹窗</h3> <p>业务需要提供了一个简易的弹窗
<img src="/Blog/images/%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%B9%E7%AA%97.png" alt=""></p> <p>最简单的调用方式，传入text属性</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>indexMgr<span class="token punctuation">.</span><span class="token function">_selfWin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>text<span class="token operator">:</span> <span class="token string">'确定提交？'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 点击确定时触发</span>
    <span class="token function">todo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>自定义内容，需要传入当前页定义好的tpl模板内容，之后 弹窗内容就展示自定义的模板</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code> indexMgr<span class="token punctuation">.</span><span class="token function">_selfWin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
     width<span class="token operator">:</span> <span class="token string">'550px'</span><span class="token punctuation">,</span>
     height<span class="token operator">:</span> <span class="token string">'300px'</span><span class="token punctuation">,</span>
     title<span class="token operator">:</span> <span class="token string">'上报至省平台'</span><span class="token punctuation">,</span>
     text<span class="token operator">:</span> <span class="token string">'成功上报'</span> <span class="token operator">+</span> num <span class="token operator">+</span> <span class="token string">'个网站年报至省平台！'</span><span class="token punctuation">,</span>
     tpl<span class="token operator">:</span> <span class="token string">'annual_report_submit_win'</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token function">todo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="form表单操作"><a href="#form表单操作" class="header-anchor">#</a> form表单操作</h2> <p><img src="/Blog/images/search.png" alt=""></p> <p>原先的搜索和显示全部方法操作繁琐，简化搜索参数赋值操作。</p> <h3 id="必要的dom结构"><a href="#必要的dom结构" class="header-anchor">#</a> 必要的DOM结构</h3> <p><strong>给form添加id，和参数有关的每一项input要添加name属性和参数名对应，showAll方法传入this参数</strong></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>table-toolbar<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>row<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>col-md-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>col-md-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-inline tr<span class="token punctuation">&quot;</span></span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>departListForm<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>datetime<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>startDate<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-control w150<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>开始时间<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>startDate<span class="token punctuation">&quot;</span></span>
                       <span class="token special-attr"><span class="token attr-name">onfocus</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript"><span class="token function">WdatePicker</span><span class="token punctuation">(</span><span class="token punctuation">{</span>dateFmt<span class="token operator">:</span><span class="token string">'yyyy-MM-dd HH:mm:ss'</span><span class="token punctuation">,</span>maxDate<span class="token operator">:</span> <span class="token string">'#F{$dp.$D(\'endDate\')}'</span><span class="token punctuation">,</span>readOnly<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span>
                       <span class="token attr-name">readonly</span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>datetime<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>endDate<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-control w150<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>结束时间<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>endDate<span class="token punctuation">&quot;</span></span>
                       <span class="token special-attr"><span class="token attr-name">onfocus</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript"><span class="token function">WdatePicker</span><span class="token punctuation">(</span><span class="token punctuation">{</span>dateFmt<span class="token operator">:</span><span class="token string">'yyyy-MM-dd HH:mm:ss'</span><span class="token punctuation">,</span>minDate<span class="token operator">:</span> <span class="token string">'#F{$dp.$D(\'startDate\')}'</span><span class="token punctuation">,</span>readOnly<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span>
                       <span class="token attr-name">readonly</span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-control w220<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>allOrgan<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>部门<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>organDn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>keywords<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>keywords<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-control w140<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>标题<span class="token punctuation">&quot;</span></span>
                       <span class="token attr-name">maxlength</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn btn-default btn-search<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript"><span class="token function">search</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>搜 索<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn btn-default btn-show-all<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onClick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript"><span class="token function">showAll</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>显示全部<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="定义好所有的查询参数"><a href="#定义好所有的查询参数" class="header-anchor">#</a> 定义好所有的查询参数</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> cur <span class="token operator">=</span> <span class="token punctuation">{</span>
    params<span class="token operator">:</span> <span class="token punctuation">{</span>
        endDate<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
        endDate<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
        keywords<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
        organDn<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
        dataFlag<span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="新的调用方式"><a href="#新的调用方式" class="header-anchor">#</a> 新的调用方式</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">search</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _tools<span class="token punctuation">.</span><span class="token function">setFormParams</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#form的id'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cur<span class="token punctuation">.</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将form表单的数据更新到cur.params上</span>
    cur<span class="token punctuation">.</span>grid<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 或者 getData() 此时的cur.params为最新值</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">showAll</span><span class="token punctuation">(</span><span class="token parameter">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    self<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">search</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">注意</p> <p>支持selectpage，特别复杂的form不支持</p></div> <h2 id="avalon数据的双向绑定"><a href="#avalon数据的双向绑定" class="header-anchor">#</a> avalon数据的双向绑定</h2> <h3 id="必要的dom结构-2"><a href="#必要的dom结构-2" class="header-anchor">#</a> 必要的DOM结构</h3> <p>给要双向绑定的父级添加ms-controller属性一般是form，input元素用ms-duplex=&quot;属性名&quot;相互绑定</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>oneLinePlay_form<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ms-controller</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>oneLinePlay_form<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>table table-bordered picture-table<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>名称：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">colspan</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>3<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ms-duplex</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span>
                                           <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-control<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">maxlength</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>20<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
               
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>

            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>是否开放：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>
                   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>radio-inline<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>radio<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>isOPen<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ms-duplex-string</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>isOPen<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> 是
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>radio-inline<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>radio<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>isOPen<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ms-duplex-string</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>isOPen<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> 否
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>

            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>

            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>food<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>发布日期：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>datetime<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>publishDate<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>publishDate<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ms-duplex</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>publishDate<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-control readonly<span class="token punctuation">&quot;</span></span> <span class="token attr-name">readonly</span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>food<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">vertical-align</span><span class="token punctuation">:</span> top<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>美食简介：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">colspan</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>content<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ms-duplex</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>content<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="定义vmid"><a href="#定义vmid" class="header-anchor">#</a> 定义vmId</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code> <span class="token keyword">var</span> cur <span class="token operator">=</span> <span class="token punctuation">{</span>
     vmId<span class="token operator">:</span> <span class="token string">'oneLinePlay_form'</span><span class="token punctuation">,</span>
 <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="请求得到数据后调用initvm函数"><a href="#请求得到数据后调用initvm函数" class="header-anchor">#</a> 请求得到数据后调用initVm函数</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code> <span class="token keyword">function</span> <span class="token function">initVm</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// obj 是数据对象</span>
     obj<span class="token punctuation">.</span>$id <span class="token operator">=</span> cur<span class="token punctuation">.</span>vmId<span class="token punctuation">;</span>
     <span class="token comment">//如果模型已经绑定，不再绑定</span>
     cur<span class="token punctuation">.</span>vm <span class="token operator">=</span> avalon<span class="token punctuation">.</span>vmodels<span class="token punctuation">[</span>obj<span class="token punctuation">.</span>$id<span class="token punctuation">]</span><span class="token punctuation">;</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cur<span class="token punctuation">.</span>vm<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         cur<span class="token punctuation">.</span>vm <span class="token operator">=</span> avalon<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
         Ls<span class="token punctuation">.</span><span class="token function">assignVM</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>vm<span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     avalon<span class="token punctuation">.</span><span class="token function">scan</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#'</span> <span class="token operator">+</span> cur<span class="token punctuation">.</span>vmId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cur<span class="token punctuation">.</span>vm<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre></div><h3 id="提交数据"><a href="#提交数据" class="header-anchor">#</a> 提交数据</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code> <span class="token keyword">var</span> data <span class="token operator">=</span> Ls<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>$model<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="常见错误"><a href="#常见错误" class="header-anchor">#</a> 常见错误</h3> <p><img src="/Blog/images/avalon.png" alt="avalon"></p> <div class="custom-block warning"><p class="custom-block-title">注意</p> <p>上图这种错误90%是因为html上绑定了ms-duplex=&quot;xxx&quot;，而数据对象里不存在xxx属性导致的；</p> <p>$id 有可能会被后端直接渲染成一个变量导致报错，可以改写成 <code>\$id</code></p></div> <h2 id="validator-表单验证"><a href="#validator-表单验证" class="header-anchor">#</a> validator 表单验证</h2> <h3 id="简易的方式-验证规则直接写在dom上"><a href="#简易的方式-验证规则直接写在dom上" class="header-anchor">#</a> 简易的方式，验证规则直接写在dom上</h3> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>keywords<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>txtinput<span class="token punctuation">&quot;</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span> <span class="token attr-name">maxlength</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>30<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-rule</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>关键词:required;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-rule</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>required;length(~30);<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-msg-required</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>姓名不能为空<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-msg-length</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>姓名最多填写30个字符<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

<span class="token comment">&lt;!--自带的验证规则--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>phone<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-rule</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>required;mobile|tel|shortTel<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-msg-required</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>联系电话不能为空<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

<span class="token comment">&lt;!--自定义的验证规则--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>search_keywords<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>keyWords<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>请输入检索内容<span class="token punctuation">&quot;</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>24<span class="token punctuation">&quot;</span></span> <span class="token attr-name">maxlength</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>30<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-rule</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>required; xxx<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-rule-xxx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>[/^.*$/, <span class="token punctuation">'</span>输入正确的检索内容<span class="token punctuation">'</span>]<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-msg-required</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>请输入需要查找的信息<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="通过js绑定"><a href="#通过js绑定" class="header-anchor">#</a> 通过js绑定</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>   cur<span class="token punctuation">.</span>form<span class="token punctuation">.</span><span class="token function">validator</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
       rules<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 自定验证规则</span>
           <span class="token function-variable function">loginName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token keyword">return</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^[a-zA-Z]\w{3,}</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>element<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
               <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> <span class="token string">&quot;mobile&quot;</span><span class="token punctuation">)</span>
               <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> <span class="token string">&quot;email&quot;</span><span class="token punctuation">)</span>
               <span class="token operator">||</span> <span class="token string">'Please fill user name, phone number or E-mail'</span><span class="token punctuation">;</span>
           <span class="token punctuation">}</span>
       <span class="token punctuation">}</span><span class="token punctuation">,</span>
       fields<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 绑定的属性要和input的name相对应</span>
           <span class="token string">'title'</span><span class="token operator">:</span> <span class="token string">'标题:required;length[1~250];'</span><span class="token punctuation">,</span>
           <span class="token string">'videoName'</span><span class="token operator">:</span> <span class="token string">'视频新闻路径:required;loginName;'</span><span class="token punctuation">,</span>
       <span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token function-variable function">valid</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">form</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 表单提交</span>
           <span class="token keyword">var</span> me <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
           <span class="token comment">// 提交表单之前，hold住表单，防止重复提交</span>
           me<span class="token punctuation">.</span><span class="token function">holdSubmit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

           Ls<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
               url<span class="token operator">:</span> url<span class="token punctuation">,</span>
               data<span class="token operator">:</span> <span class="token function">$</span><span class="token punctuation">(</span>form<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
               <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                   <span class="token comment">// 提交表单成功后，释放hold</span>
                   me<span class="token punctuation">.</span><span class="token function">holdSubmit</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token punctuation">}</span>
           <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span><span class="token punctuation">,</span>
       msgClass<span class="token operator">:</span> <span class="token string">&quot;n-top&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 提示信息位置</span>
       timely<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment">// 触发验证方式</span>
       ignore<span class="token operator">:</span> <span class="token string">':hidden'</span> <span class="token comment">// 隐藏的dom结构不验证</span>
   <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>对于同一个form表单不同情况下，验证字段不一样的情况，可以如下操作</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">setValid</span><span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> fields <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">'title'</span><span class="token operator">:</span> <span class="token string">'名称:required;length[1~250];'</span><span class="token punctuation">,</span>
        <span class="token string">'tel'</span><span class="token operator">:</span> <span class="token string">'景区电话:required;'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">'scenic'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        fields <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'title'</span><span class="token operator">:</span> <span class="token string">'名称:required;length[1~250];'</span><span class="token punctuation">,</span>
            <span class="token string">'pos'</span><span class="token operator">:</span> <span class="token string">'电子地图:required;'</span><span class="token punctuation">,</span>
            <span class="token string">'intro'</span><span class="token operator">:</span> <span class="token string">'景点介绍:required;'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">'food'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        fields <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'title'</span><span class="token operator">:</span> <span class="token string">'名称:required;length[1~250];'</span><span class="token punctuation">,</span>
            <span class="token string">'type'</span><span class="token operator">:</span> <span class="token string">'美食类型:required;'</span><span class="token punctuation">,</span>
            <span class="token string">'content'</span><span class="token operator">:</span> <span class="token string">'美食简介:required;'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    cur<span class="token punctuation">.</span>form<span class="token punctuation">.</span><span class="token function">validator</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        fields<span class="token operator">:</span> fields<span class="token punctuation">,</span>
        msgClass<span class="token operator">:</span> <span class="token string">'n-top'</span><span class="token punctuation">,</span>
        timely<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        ignore<span class="token operator">:</span> <span class="token string">':hidden'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="判断表单是否验证通过"><a href="#判断表单是否验证通过" class="header-anchor">#</a> 判断表单是否验证通过</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>cur<span class="token punctuation">.</span>form<span class="token punctuation">.</span><span class="token function">isValid</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="表单校验的触发"><a href="#表单校验的触发" class="header-anchor">#</a> 表单校验的触发</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>cur<span class="token punctuation">.</span>form<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">&quot;validate&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

cur<span class="token punctuation">.</span>form<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="表格grid"><a href="#表格grid" class="header-anchor">#</a> 表格grid</h2> <p>html结构简单说明，添加class<code>ls-mini-datagrid</code>是为了<code>width=&quot;100%&quot;</code>的那一项在小分辨率正常显示，且有最小默认宽度，<code>cellStyle</code>可修改最小宽度。</p> <p>表格中只有个项的宽度为100%，其他以数值分割大小</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>datagrid<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mini-datagrid ls-mini-datagrid<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span>100%<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span>
     <span class="token attr-name">multiSelect</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
     <span class="token attr-name">sizeList</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>[15,30,45]<span class="token punctuation">&quot;</span></span> <span class="token attr-name">pageSize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>15<span class="token punctuation">&quot;</span></span> <span class="token attr-name">allowCellSelect</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onlyCheckSelection</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onlyCheckSelection</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
     <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/survey/theme/getPage<span class="token punctuation">&quot;</span></span> <span class="token attr-name">allowCellWrap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">allowHeaderWrap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>columns<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--序号--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>indexcolumn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--勾选--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkcolumn<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>40<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fieldWidth<span class="token punctuation">&quot;</span></span> <span class="token attr-name">field</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100%<span class="token punctuation">&quot;</span></span> <span class="token attr-name">headerAlign</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>left<span class="token punctuation">&quot;</span></span>
             <span class="token attr-name">cellStyle</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>min-width: 150px;<span class="token punctuation">&quot;</span></span> <span class="token attr-name">renderer</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>renderTitle<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>主题
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">field</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>publishDate<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>200<span class="token punctuation">&quot;</span></span> <span class="token attr-name">headerAlign</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dateFormat</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>yyyy-MM-dd HH:mm:ss<span class="token punctuation">&quot;</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span> <span class="token attr-name">allowSort</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>发布日期<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="表格的实例化和设置高度"><a href="#表格的实例化和设置高度" class="header-anchor">#</a> 表格的实例化和设置高度</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 老版</span>
cur<span class="token punctuation">.</span>grid <span class="token operator">=</span> mini<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;datagrid&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Ls<span class="token punctuation">.</span><span class="token function">mini_datagrid_height</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>grid<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 新版 </span>
cur<span class="token punctuation">.</span>grid <span class="token operator">=</span> Ls<span class="token punctuation">.</span><span class="token function">gridParse</span><span class="token punctuation">(</span><span class="token string">'datagrid'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="表格请求数据"><a href="#表格请求数据" class="header-anchor">#</a> 表格请求数据</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>cur<span class="token punctuation">.</span>grid<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 提供了请求完成的回调函数</span>
cur<span class="token punctuation">.</span>grid<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>params<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resp</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>resp<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="表格数据重新加载"><a href="#表格数据重新加载" class="header-anchor">#</a> 表格数据重新加载</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>cur<span class="token punctuation">.</span>grid<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="表格勾选事件监听"><a href="#表格勾选事件监听" class="header-anchor">#</a> 表格勾选事件监听</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>cur<span class="token punctuation">.</span>grid<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;beforeselect&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> disabledStr <span class="token operator">=</span> e<span class="token punctuation">.</span>record<span class="token punctuation">.</span>isPublish<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>disabledStr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span>cancel <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token comment">// 不允许勾选</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="表格勾选完成后的数据调用"><a href="#表格勾选完成后的数据调用" class="header-anchor">#</a> 表格勾选完成后的数据调用</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">use</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> ids <span class="token operator">=</span> id <span class="token operator">?</span> <span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">:</span> indexMgr<span class="token punctuation">.</span><span class="token function">_getGridSelectProp</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>grid<span class="token punctuation">,</span> <span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// _getGridSelectProp 的第二个参数是 以哪个属性为提交参数</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ids<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Ls<span class="token punctuation">.</span><span class="token function">tipsInfo</span><span class="token punctuation">(</span><span class="token string">'请选择数据'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    Ls<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> url<span class="token punctuation">,</span>
        data<span class="token operator">:</span> <span class="token punctuation">{</span>
            ids<span class="token operator">:</span> ids<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="表格数据渲染的两种方式"><a href="#表格数据渲染的两种方式" class="header-anchor">#</a> 表格数据渲染的两种方式</h3> <ol><li>renderer
grid中通过field=&quot;属性名&quot;，便可以渲染数据，如果要改写数据在该项上添加renderer</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// renderer=&quot;renderTitle&quot;   </span>

<span class="token keyword">function</span> <span class="token function">renderTitle</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> rec <span class="token operator">=</span> e<span class="token punctuation">.</span>record<span class="token punctuation">,</span> 
        title <span class="token operator">=</span> rec<span class="token punctuation">.</span>title<span class="token punctuation">,</span>
        str <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> str<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>ondrawcell
在表头上添加<code>ondrawcell=&quot;onDrawCell&quot;</code></li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 适用于多个项需要改写的表格</span>

<span class="token keyword">function</span> <span class="token function">onDrawCell</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> node <span class="token operator">=</span> e<span class="token punctuation">.</span>node<span class="token punctuation">,</span>
        record <span class="token operator">=</span> e<span class="token punctuation">.</span>record<span class="token punctuation">,</span>
        field <span class="token operator">=</span> e<span class="token punctuation">.</span>field<span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>field <span class="token operator">===</span> <span class="token string">&quot;title&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span>cellHtml <span class="token operator">=</span> <span class="token string">'&lt;a class=&quot;blue&quot; href=&quot;javascript:void(0)&quot; onclick=&quot;pmcProjectView('</span> <span class="token operator">+</span> record<span class="token punctuation">.</span>id <span class="token operator">+</span> <span class="token string">')&quot;&gt;'</span> <span class="token operator">+</span> record<span class="token punctuation">.</span>title <span class="token operator">+</span> <span class="token string">'&lt;/a&gt;'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//考核周期</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>field <span class="token operator">===</span> <span class="token string">&quot;rangeDate&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> start <span class="token operator">=</span> Ls<span class="token punctuation">.</span><span class="token function">dateFormat</span><span class="token punctuation">(</span>record<span class="token punctuation">.</span>startDate<span class="token punctuation">,</span> <span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            end <span class="token operator">=</span> Ls<span class="token punctuation">.</span><span class="token function">dateFormat</span><span class="token punctuation">(</span>record<span class="token punctuation">.</span>endDate<span class="token punctuation">,</span> <span class="token string">'yyyy-MM-dd'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        e<span class="token punctuation">.</span>cellHtml <span class="token operator">=</span> start <span class="token operator">+</span> <span class="token string">'~'</span> <span class="token operator">+</span> end<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>field <span class="token operator">===</span> <span class="token string">&quot;opt&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> btnStr <span class="token operator">=</span> <span class="token string">'&lt;button type=&quot;button&quot; class=&quot;btn btn-default btn-sm btn-edit&quot; onclick=&quot;addOrEdit('</span> <span class="token operator">+</span> record<span class="token punctuation">.</span>id <span class="token operator">+</span>
            <span class="token string">')&quot;&gt;编辑&lt;/button&gt;&amp;nbsp;&amp;nbsp;&lt;button type=&quot;button&quot; class=&quot;btn btn-default btn-sm btn-edit&quot; onclick=&quot;deleteProjects('</span> <span class="token operator">+</span> record<span class="token punctuation">.</span>id <span class="token operator">+</span>
            <span class="token string">')&quot;&gt;删除&lt;/button&gt;'</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> btnStr2 <span class="token operator">=</span> <span class="token string">'&lt;button type=&quot;button&quot; disabled class=&quot;btn btn-sm disabled-btn&quot;&gt;编辑&lt;/button&gt;&amp;nbsp;'</span> <span class="token operator">+</span>
            <span class="token string">'&amp;nbsp;&lt;button type=&quot;button&quot; disabled class=&quot;btn btn-sm disabled-btn&quot;&gt;删除&lt;/button&gt;'</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>record<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span>cellHtml <span class="token operator">=</span> btnStr<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span>cellHtml <span class="token operator">=</span> btnStr2<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="ztree"><a href="#ztree" class="header-anchor">#</a> ztree</h2> <h3 id="异步树"><a href="#异步树" class="header-anchor">#</a> 异步树</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> ztree_settings <span class="token operator">=</span> <span class="token punctuation">{</span>
    view<span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token function-variable function">addDiyDom</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">treeId<span class="token punctuation">,</span> node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 自定义树节点上的按钮</span>
            <span class="token keyword">var</span> aObj <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#&quot;</span> <span class="token operator">+</span> node<span class="token punctuation">.</span>tId <span class="token operator">+</span> <span class="token string">&quot;_a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> editBtn <span class="token operator">=</span> <span class="token string">' &lt;span class=&quot;button edit-a&quot; id=&quot;editBtn_'</span> <span class="token operator">+</span> node<span class="token punctuation">.</span>organId <span class="token operator">+</span> <span class="token string">'&quot; title=&quot;修改&quot;&gt;&lt;/span&gt;'</span><span class="token punctuation">;</span>
            aObj<span class="token punctuation">.</span><span class="token function">after</span><span class="token punctuation">(</span>editBtn<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> editBtn <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#editBtn_&quot;</span> <span class="token operator">+</span> node<span class="token punctuation">.</span>organId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
            editBtn <span class="token operator">&amp;&amp;</span> editBtn<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    async<span class="token operator">:</span> <span class="token punctuation">{</span>
        enable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        url<span class="token operator">:</span> url<span class="token punctuation">,</span>
        autoParam<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;id=parentId&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;organId&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 异步加载时需要自动提交父节点属性的参数</span>
        otherParam<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;catalog&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;false&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//  请求提交的静态参数键值对</span>
        <span class="token function-variable function">dataFilter</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">dataFilter</span><span class="token punctuation">(</span><span class="token parameter">treeId<span class="token punctuation">,</span> parentNode<span class="token punctuation">,</span> responseData</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 树数据过滤器</span>
            <span class="token keyword">var</span> responseData <span class="token operator">=</span> Ls<span class="token punctuation">.</span><span class="token function">treeDataFilter</span><span class="token punctuation">(</span>responseData<span class="token punctuation">,</span> Ls<span class="token punctuation">.</span>treeDataType<span class="token punctuation">.</span><span class="token constant">PUBLIC_CONTENT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> responseData<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    data<span class="token operator">:</span> <span class="token punctuation">{</span>
        simpleData<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 构成父子关系的字段</span>
            idKey<span class="token operator">:</span> <span class="token string">'id'</span><span class="token punctuation">,</span>
            pIdKey<span class="token operator">:</span> <span class="token string">'parentId'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    callback<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">onClick</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> treeId<span class="token punctuation">,</span> node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 点击事件</span>
           console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">onAsyncSuccess</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 异步加载完成的回调事件</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isInit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// 只有一条是自动展开</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>cur<span class="token punctuation">.</span>tree<span class="token punctuation">.</span><span class="token function">getNodes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    cur<span class="token punctuation">.</span>tree<span class="token punctuation">.</span><span class="token function">expandNode</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>tree<span class="token punctuation">.</span><span class="token function">getNodes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                isInit <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token comment">// 添加模拟滚动条</span>
                App<span class="token punctuation">.</span><span class="token function">initContentScroll</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;#&quot;</span> <span class="token operator">+</span> cur<span class="token punctuation">.</span>tree_id<span class="token punctuation">,</span> <span class="token punctuation">{</span>
                    bottom<span class="token operator">:</span> <span class="token string">'-9px'</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
cur<span class="token punctuation">.</span>tree <span class="token operator">=</span> $<span class="token punctuation">.</span>fn<span class="token punctuation">.</span>zTree<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#&quot;</span> <span class="token operator">+</span> cur<span class="token punctuation">.</span>tree_id<span class="token punctuation">)</span><span class="token punctuation">,</span> ztree_settings<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="同步树"><a href="#同步树" class="header-anchor">#</a> 同步树</h3> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
     id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
     parentId<span class="token operator">:</span> <span class="token string">'-1'</span><span class="token punctuation">,</span>
     name<span class="token operator">:</span> <span class="token string">'目录列表'</span><span class="token punctuation">,</span>
     open<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
     children<span class="token operator">:</span> d<span class="token punctuation">.</span>data<span class="token punctuation">,</span>
     <span class="token string">&quot;icon&quot;</span><span class="token operator">:</span> <span class="token constant">GLOBAL_CONTEXTPATH</span> <span class="token operator">+</span> <span class="token string">&quot;/assets/images/organ.gif&quot;</span><span class="token punctuation">,</span>
 <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ztree_settings <span class="token operator">=</span> <span class="token punctuation">{</span>
    view<span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token function-variable function">addDiyDom</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">treeId<span class="token punctuation">,</span> node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 自定义树节点上的按钮</span>
            <span class="token keyword">var</span> aObj <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#&quot;</span> <span class="token operator">+</span> node<span class="token punctuation">.</span>tId <span class="token operator">+</span> <span class="token string">&quot;_a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> editBtn <span class="token operator">=</span> <span class="token string">' &lt;span class=&quot;button edit-a&quot; id=&quot;editBtn_'</span> <span class="token operator">+</span> node<span class="token punctuation">.</span>organId <span class="token operator">+</span> <span class="token string">'&quot; title=&quot;修改&quot;&gt;&lt;/span&gt;'</span><span class="token punctuation">;</span>
            aObj<span class="token punctuation">.</span><span class="token function">after</span><span class="token punctuation">(</span>editBtn<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> editBtn <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#editBtn_&quot;</span> <span class="token operator">+</span> node<span class="token punctuation">.</span>organId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
            editBtn <span class="token operator">&amp;&amp;</span> editBtn<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    data<span class="token operator">:</span> <span class="token punctuation">{</span>
        simpleData<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 构成父子关系的字段</span>
            idKey<span class="token operator">:</span> <span class="token string">'id'</span><span class="token punctuation">,</span>
            pIdKey<span class="token operator">:</span> <span class="token string">'parentId'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    callback<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">onClick</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> treeId<span class="token punctuation">,</span> node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 点击事件</span>
           console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 初始化树</span>
cur<span class="token punctuation">.</span>tree <span class="token operator">=</span> $<span class="token punctuation">.</span>fn<span class="token punctuation">.</span>zTree<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#&quot;</span> <span class="token operator">+</span> cur<span class="token punctuation">.</span>tree_id<span class="token punctuation">)</span><span class="token punctuation">,</span> ztree_settings<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/single-web/assets/js/app.25aedf86.js" defer></script><script src="/single-web/assets/js/2.bdf7e3fa.js" defer></script><script src="/single-web/assets/js/8.f7cfc9af.js" defer></script>
  </body>
</html>
